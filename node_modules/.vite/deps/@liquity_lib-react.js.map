{
  "version": 3,
  "sources": ["../../../../lib-react/src/components/LiquityStoreProvider.tsx", "../../../../lib-react/src/hooks/useLiquityStore.ts", "../../../../lib-react/src/utils/equals.ts", "../../../../lib-react/src/hooks/useLiquityReducer.ts", "../../../../lib-react/src/hooks/useLiquitySelector.ts", "../../../../lib-react/index.ts"],
  "sourcesContent": ["import { LiquityStore } from \"@liquity/lib-base\";\nimport React, { createContext, useEffect, useState } from \"react\";\n\nexport const LiquityStoreContext = createContext<LiquityStore | undefined>(undefined);\n\ntype LiquityStoreProviderProps = {\n  store: LiquityStore;\n  loader?: React.ReactNode;\n};\n\nexport const LiquityStoreProvider: React.FC<LiquityStoreProviderProps> = ({\n  store,\n  loader,\n  children\n}) => {\n  const [loadedStore, setLoadedStore] = useState<LiquityStore>();\n\n  useEffect(() => {\n    store.onLoaded = () => setLoadedStore(store);\n    const stop = store.start();\n\n    return () => {\n      store.onLoaded = undefined;\n      setLoadedStore(undefined);\n      stop();\n    };\n  }, [store]);\n\n  if (!loadedStore) {\n    return <>{loader}</>;\n  }\n\n  return <LiquityStoreContext.Provider value={loadedStore}>{children}</LiquityStoreContext.Provider>;\n};\n", "import { useContext } from \"react\";\n\nimport { LiquityStore } from \"@liquity/lib-base\";\n\nimport { LiquityStoreContext } from \"../components/LiquityStoreProvider\";\n\nexport const useLiquityStore = <T>(): LiquityStore<T> => {\n  const store = useContext(LiquityStoreContext);\n\n  if (!store) {\n    throw new Error(\"You must provide a LiquityStore via LiquityStoreProvider\");\n  }\n\n  return store as LiquityStore<T>;\n};\n", "type UnknownObject = Record<string, unknown>;\n\nconst hasOwnProperty = (o: UnknownObject, key: string) =>\n  Object.prototype.hasOwnProperty.call(o, key);\n\nconst shallowEquals = (a: UnknownObject, b: UnknownObject) => {\n  const keysA = Object.keys(a);\n  const keysB = Object.keys(b);\n\n  return (\n    keysA.length === keysB.length &&\n    keysA.every(key => hasOwnProperty(b, key) && Object.is(a[key], b[key]))\n  );\n};\n\nconst isObject = (a: unknown): a is UnknownObject => a !== null && typeof a === \"object\";\n\nexport const equals = (a: unknown, b: unknown): boolean =>\n  isObject(a) && isObject(b) ? shallowEquals(a, b) : Object.is(a, b);\n", "import { useCallback, useEffect, useReducer, useRef } from \"react\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\n\nimport { equals } from \"../utils/equals\";\nimport { useLiquityStore } from \"./useLiquityStore\";\n\nexport type LiquityStoreUpdate<T = unknown> = {\n  type: \"updateStore\";\n  newState: LiquityStoreState<T>;\n  oldState: LiquityStoreState<T>;\n  stateChange: Partial<LiquityStoreState<T>>;\n};\n\nexport const useLiquityReducer = <S, A, T>(\n  reduce: (state: S, action: A | LiquityStoreUpdate<T>) => S,\n  init: (storeState: LiquityStoreState<T>) => S\n): [S, (action: A | LiquityStoreUpdate<T>) => void] => {\n  const store = useLiquityStore<T>();\n  const oldStore = useRef(store);\n  const state = useRef(init(store.state));\n  const [, rerender] = useReducer(() => ({}), {});\n\n  const dispatch = useCallback(\n    (action: A | LiquityStoreUpdate<T>) => {\n      const newState = reduce(state.current, action);\n\n      if (!equals(newState, state.current)) {\n        state.current = newState;\n        rerender();\n      }\n    },\n    [reduce]\n  );\n\n  useEffect(() => store.subscribe(params => dispatch({ type: \"updateStore\", ...params })), [\n    store,\n    dispatch\n  ]);\n\n  if (oldStore.current !== store) {\n    state.current = init(store.state);\n    oldStore.current = store;\n  }\n\n  return [state.current, dispatch];\n};\n", "import { useEffect, useReducer } from \"react\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\n\nimport { equals } from \"../utils/equals\";\nimport { useLiquityStore } from \"./useLiquityStore\";\n\nexport const useLiquitySelector = <S, T>(select: (state: LiquityStoreState<T>) => S): S => {\n  const store = useLiquityStore<T>();\n  const [, rerender] = useReducer(() => ({}), {});\n\n  useEffect(\n    () =>\n      store.subscribe(({ newState, oldState }) => {\n        if (!equals(select(newState), select(oldState))) {\n          rerender();\n        }\n      }),\n    [store, select]\n  );\n\n  return select(store.state);\n};\n", "export * from \"./src/components/LiquityStoreProvider\";\n\nexport * from \"./src/hooks/useLiquityStore\";\nexport * from \"./src/hooks/useLiquityReducer\";\nexport * from \"./src/hooks/useLiquitySelector\";\n"],
  "mappings": "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",
  "names": []
}
